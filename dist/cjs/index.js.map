{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["import {\n    IState, IOption,\n    IPageNavQuery,\n    IPageCtx, IPageSlice, IPageRange, IRelPage, IRelPageCtx, IRecordCtx, ISpreadCtx, TSpreadCtx,\n    ICmpAttrQuery, ICmpAttr, ICmpBtnAttr, ICmpSelectAttr, ISelectEvt, TPageList,\n    TFn\n} from './type';\n\n/**\n * Usage:\n *      const list = ['a', 'b', 'c', 'd'];\n *\n *      const example = pgnHandle.getState(list, {\n *           page: 1,                       // optional starting page index\n *           increment: [100, 200, 300],    // used for <select>'s <option> (default 10 per page, i.e. [10])\n *           incrementIdx: 0,               // i.e. 100 per age\n *      });\n *\n *      const { startIdx, endIdx } = example;\n *      const listFor1stPage = list.slice(startIdx, endIdx);\n */\nexport class PgnHandle {\n    //// Option\n    /**\n     * Merge the updated option with existing option (either custom or default)\n     * e.g. existingOption = this.state.sortOption\n     */\n    getOption(modOption: Partial<IOption>, existingOption?: IOption): IOption {\n        const baseOption = existingOption ? existingOption : this.getDefOption();\n        return { ...baseOption, ...modOption };\n    }\n\n    getDefOption(): IOption {\n        return {\n            page: 0,\n            increment: [10],\n            incrementIdx: 0,\n            maxSpread: 3\n        };\n    }\n\n    //// Full State\n    getState(list: any[], pgnOption: Partial<IOption>): IState {\n        // Merge def. option with User's option\n        const defOption: IOption = this.getDefOption();\n        const { increment: [defIncrmVal] } = defOption;\n        const { page, increment, incrementIdx, maxSpread } = Object.assign(defOption, pgnOption);\n        let perPage: number = this.getNoPerPage(increment, incrementIdx, defIncrmVal);\n\n        // Skip if we only have 1 list item OR less than 2 pages\n        const totalRecord: number = list.length;\n        const defState: IState = this.getDefState(totalRecord, perPage);\n        if (totalRecord <= 1) return defState;\n        const totalPage: number = this.getTotalPage(totalRecord, perPage);\n        if (totalPage <= 1) return defState;\n\n        // Proceed as we have >=2 pages\n        const { curr, pageNo }: IPageCtx = this.getCurrPage(page, totalPage - 1);\n        const currSlice: IPageSlice = this.getPageSliceIdx(list, perPage, curr);\n        const { startIdx, endIdx } = currSlice;\n        const recordCtx = this.getRecordCtx(totalRecord, startIdx, endIdx);\n        const spreadCtx: ISpreadCtx = this.getSpreadCtx(pageNo, totalPage, maxSpread);\n        let relPage: IRelPage = this.getRelPage(totalPage, curr);\n        const relPageCtx: IRelPageCtx = this.getRelPageCtx({ curr, last: relPage.last }, relPage);\n        relPage = this.parseRelPage(relPage, relPageCtx);\n\n        return { curr, ...relPage, ...currSlice, pageNo, perPage, totalPage, ...recordCtx, ...spreadCtx };\n    }\n\n    getDefState(totalRecord: number, perPage: number): IState {\n        const startIdx: number = 0;\n        const recordCtx: IRecordCtx = this.getRecordCtx(totalRecord, startIdx);\n        return {\n            ...recordCtx,\n            perPage,\n            totalPage: 1,\n            startIdx,\n            pageNo: 1\n        } as IState;\n    }\n\n    //// Partial State\n    getRecordCtx(totalRecord: number, startIdx: number, endIdx?: number): IRecordCtx {\n        const hsRecord: boolean = totalRecord >= 1;\n        return {\n            startRecord: (hsRecord && Number.isInteger(startIdx)) ? startIdx + 1 : 0,\n            endRecord: (hsRecord && Number.isInteger(endIdx)) ? endIdx : totalRecord,\n            totalRecord\n        };\n    }\n\n    getNoPerPage(incrms: number[], incrmIdx: number, fallbackVal: number): number {\n        const hsIncrms: boolean = !!incrms.length;\n        if (!hsIncrms) return fallbackVal;\n\n        const incrm: number = incrms[incrmIdx];\n        const isValidIncrm: boolean = Number.isInteger(incrm) && incrm > 0;\n        const perPage: number = isValidIncrm ? incrms[incrmIdx] : fallbackVal;\n        return perPage;\n    }\n\n    parseNoPerPage(incrms: number[]): number[] {\n        return incrms.filter((incrm: number) => {\n            return Number.isInteger(incrm) && incrm > 0;\n        });\n    }\n\n    getTotalPage(lsLen: number, perPage: number): number {\n        const noOfPage: number = (lsLen > perPage) ? lsLen / perPage : 1;\n        return Math.ceil(noOfPage);\n    }\n\n    getCurrPage(page: number, lastPage: number): IPageCtx {\n        const curr: number = (page >= 0 && page <= lastPage) ? page : 0;\n        const pageNo: number = curr + 1;\n        return { curr, pageNo };\n    }\n\n    getRelPage(totalPage: number, currPage: number): IRelPage {\n        return {\n            first: 0,\n            prev: currPage - 1,\n            next: currPage + 1,\n            last: totalPage - 1\n        };\n    }\n\n    getRelPageCtx(pageRange: IPageRange, relPage: IRelPage): IRelPageCtx {\n        const relPageKeys = Object.getOwnPropertyNames(relPage) as (keyof IRelPage)[];\n        return relPageKeys.reduce((relPageCtx, type: string) => {\n            const pageQuery: IPageNavQuery = { type, target: relPage[type] };\n            relPageCtx[type] = this.canNavToPage(pageRange, pageQuery);\n            return relPageCtx;\n        }, {}) as IRelPageCtx;\n    }\n\n    parseRelPage(relPage: IRelPage, relPageCtx: IRelPageCtx): IRelPage {\n        const relPageKeys = Object.getOwnPropertyNames(relPage) as (keyof IRelPage)[];\n        relPageKeys.forEach((pageType: keyof IRelPage) => {\n            const page: number = relPage[pageType];\n            relPage[pageType] = relPageCtx[pageType] ? page : null;\n        });\n        return relPage;\n    }\n\n    getPageSliceIdx(list: any[], perPage: number, page: number): IPageSlice {\n        let startIdx: number = page * perPage;     // inclusive index\n        let endIdx: number = startIdx + perPage;      // exclusive index\n        startIdx = this.isDefined(list[startIdx]) ? startIdx : undefined;   // `undefined` is used as `null` cant be used as empty value in ES6\n        endIdx = this.isDefined(list[endIdx]) ? endIdx : undefined;\n        return { startIdx, endIdx };\n    }\n\n    /**\n     * Get the page number for the left/right spread in relation to current page\n     * - When remain < maxSpread, show `maxSpread` no. of pages\n     * - When remain > maxSpread, show dots (either on left/right) + `maxSpread` no. of pages\n     * - when remain < 1, no spread is available\n     *\n     * @param maxSpread: max no. of pages for each side of the spread\n     */\n    getSpreadCtx(currPageNo: number, totalPage: number, maxSpread: number = 3): ISpreadCtx {\n        // 1 is added to `spreadRange` in case there is '...' for either 1st/last item\n        const spreadRange: any[] = [...Array(maxSpread + 1)];\n        const firstPage: number = 1;\n        const DOTS = '...';\n\n        const rtTotalRemain: number = totalPage - currPageNo;\n        const ltTotalRemain: number = currPageNo - firstPage;\n        const hsRtSpread: boolean = rtTotalRemain > 1 && rtTotalRemain < totalPage;\n        const hsLtSpread: boolean = ltTotalRemain > 1 && ltTotalRemain < totalPage;\n\n        const rtSpread: TSpreadCtx = hsRtSpread ?\n            spreadRange.reduce((container: TSpreadCtx, item, idx: number) => {\n                const pageNo: number = currPageNo + idx + 1;\n\n                // We exclude the 1st page or last page since its already available in the Pagination state\n                const isInRange: boolean = pageNo > 1 && pageNo < totalPage;\n\n                // Check if there is any pages between \"last\" page number in this loop and the actual last page\n                // - e.g. last page in the loop is: 8 | actual last page is: 10,\n                // so we have page 9 in between, which we can use '...' to represent\n                const hsGtOnePageTilLastPage: boolean = idx === maxSpread && (totalPage - pageNo) >= 1;\n\n                if (isInRange) container.push(hsGtOnePageTilLastPage ? DOTS : pageNo);\n                return container;\n            }, []) :\n            null;\n\n        const ltSpread: TSpreadCtx = hsLtSpread ?\n            spreadRange.reduce((container: TSpreadCtx, item, idx: number) => {\n                const pageNo: number = currPageNo - idx - 1;\n                const isInRange: boolean = pageNo > 1 && pageNo < totalPage;\n                const hsGtOnePageTilFirstPage: boolean = idx === maxSpread && (currPageNo - pageNo) >= 1;\n                if (isInRange) container.unshift(hsGtOnePageTilFirstPage ? DOTS : pageNo);\n                return container;\n            }, []) :\n            null;\n\n        return { ltSpread, rtSpread, maxSpread };\n    }\n\n    /**\n     * Forumla for calculating corresponding page index for left/right spread '...' based on the\n     * context of current page and the maxSpread (no. of pages between current and target page)\n     *\n     * e.g. maxSpread = 3\n     * ------------------------------------------------------------\n     * Current Page          | Spread/Target Page    | Spread Type\n     * No.      | Index      | No.      | Index      |\n     * ------------------------------------------------------------\n     * 1          0            4          3            Right Spread\n     * 10         9            6          5            Left Spread\n     */\n    getPageIdxForSpread(currPageIdx: number, maxSpread: number, isLtSpread: boolean): number {\n        return isLtSpread ?\n            (currPageIdx - maxSpread - 1) :\n            (currPageIdx + maxSpread + 1) ;\n    }\n\n    //// Helper Methods\n    canNavToPage({ curr, last }: IPageRange, { type, target }: IPageNavQuery): boolean {\n        if (!this.isGteZero([curr, last])) return false;\n\n        switch (type) {\n            case 'prev':\n                // we dont need `target < curr` since we already know `target = curr - 1;`\n                return target >= 0;\n            case 'next':\n                // we dont need `target > curr` since we already know `target = curr + 1;`\n                return target <= last;\n            case 'first':\n                // we dont need `target > curr` since we already know `target = 0`\n                return curr !== 0 && target < curr;\n            case 'last':\n                return target > curr;\n            case 'page':\n                // i.e. any prev or next\n                return this.isGteZero(target) && target !== curr && target <= last;\n            default:\n                return false;\n        }\n    }\n\n    isDefined(val?: any): boolean {\n        return typeof val !== 'undefined';\n    }\n\n    isGteZero(vals: any | any[]): boolean {\n        return Array.isArray(vals) ?\n            vals.every((val: any) => (Number.isInteger(val) && val >= 0)) :\n            Number.isInteger(vals) && vals >= 0;\n    }\n\n    //// Generic UI Component Related\n    /**\n     * Create Generic Attributes that can be passed/mapped to Attributes/Inputs/Props of Static HTML or Angular/React/Vue/etc Components\n     *\n     * - Usage Example for React:\n     * const callback = (modState => this.setState({...this.state, ...modState})).bind(this);\n     * createGenericCmpProps({option, state, data, callback});\n     */\n    createGenericCmpAttr({ data, option, state, callback }: ICmpAttrQuery): ICmpAttr {\n        const { first, prev, next, last, ltSpread, rtSpread } = state;\n        const onEvt: TFn = this.getGenericCmpEvtHandler(data, option, callback);\n\n        return {\n            // Attr. for First/Prev/Next/Last as Button\n            firstBtnAttr: this.getTextBtnAttr(onEvt, ['first', first]),\n            prevBtnAttr: this.getTextBtnAttr(onEvt, ['prev', prev]),\n            nextBtnAttr: this.getTextBtnAttr(onEvt, ['next', next]),\n            lastBtnAttr: this.getTextBtnAttr(onEvt, ['last', last]),\n\n            // Attr. for Spread as Button\n            ltSpreadBtnsAttr: ltSpread ?\n                ltSpread.map((page: number) => this.getSpreadBtnAttr(onEvt, state, [page, true])) :\n                null,\n            rtSpreadBtnsAttr: rtSpread ?\n                rtSpread.map((page: number) => this.getSpreadBtnAttr(onEvt, state, [page, false])) :\n                null,\n\n            // Attr. for Page Select and Per Page Select\n            perPageSelectAttr: this.getPerPageSelectAttr(onEvt, option),\n            pageSelectAttr: this.getPageSelectAttr(onEvt, state),\n        };\n    }\n\n    getTextBtnAttr(onEvt: TFn, [title, pageIdx]: [string, number]): ICmpBtnAttr {\n        return {\n            title,\n            disabled: !Number.isInteger(pageIdx),\n            onClick: () => onEvt({\n                page: pageIdx\n            })\n        };\n    }\n\n    getSpreadBtnAttr(onEvt: TFn, state: IState, [page, isLtSpread]: [any, boolean]): ICmpBtnAttr {\n        const { curr, maxSpread } = state;\n\n        // If the page is not a number, then its likely dots '...' so page is jumped by an interval of `maxSpread`\n        // - e.g. maxSpread = 3, currPageNo = 6\n        // then the page is jumped to 2 (eqv. to page index of 3)\n        const isNum: boolean = typeof page === 'number';\n        // const pageIdx = isNum ? page - 1 : curr;\n        const targetPageIdx: number = isLtSpread ?\n            (isNum ? curr - 1 : this.getPageIdxForSpread(curr, maxSpread, true) ):\n            (isNum ? curr + 1 : this.getPageIdxForSpread(curr, maxSpread, false));\n\n        return {\n            title: isNum ? page : (isLtSpread ? 'left-spread' : 'right-spread'),\n            isSpread: !isNum,\n            onClick: () => onEvt({\n                page: targetPageIdx\n            })\n        };\n    }\n\n    getPageSelectAttr(onEvt: TFn, state: IState): ICmpSelectAttr {\n        const { pageNo, totalPage, ltSpread, rtSpread } = state;\n\n        const isLteOnePage: boolean = totalPage <= 1;\n\n        // Options (inclusive of all pages here)\n        const leftOptions: TPageList = (isLteOnePage || pageNo === 1) ?\n            [ 1 ] :\n            [ 1, ...(ltSpread ? ltSpread : []), pageNo ];\n\n        const rightOptions: TPageList = (isLteOnePage || pageNo === totalPage) ?\n            [] :\n            [ ...(rtSpread ? rtSpread : []), totalPage ];\n\n        const options: TPageList = [ ...leftOptions, ...rightOptions ];\n        const selectedOptionIdx: number = leftOptions.length - 1;\n\n        return {\n            title: 'page select',\n            disabled: isLteOnePage,\n            options,\n            selectedOptionValue: pageNo,\n            selectedOptionIdx,\n            onSelect: ({ target }: ISelectEvt) => {\n                const targetPageIdx: number = this.getTargetPageIdxByPos(\n                    state,\n                    options,\n                    [ parseInt(target.value, 10), selectedOptionIdx ]\n                );\n                onEvt({ page: targetPageIdx });\n            }\n        };\n    }\n\n    getPerPageSelectAttr(onEvt: TFn, option: IOption): ICmpSelectAttr {\n        const { increment, incrementIdx } = option;\n        return {\n            title: 'per page select',\n            disabled: increment.length <= 1,\n            options: increment,\n            selectedOptionValue: increment[incrementIdx],\n            selectedOptionIdx: incrementIdx,\n            onSelect: ({ target }: ISelectEvt) => onEvt({\n                page: 0,\n                incrementIdx: parseInt(target.value, 10)\n            })\n        };\n    }\n\n    getGenericCmpEvtHandler(data: any[], option: IOption, callback?: TFn): TFn {\n        return ((modOption: Partial<IOption>): void => {\n            const pgnOption: IOption = this.getOption(modOption, option);\n            const pgnState: IState = this.getState(data, pgnOption);\n            if (callback) callback({ pgnOption, pgnState });\n        });\n    }\n\n    getTargetPageIdxByPos(state: IState, pages: TPageList, [currPos, activePos]: [number, number]): number {\n        const { curr, maxSpread } = state;\n        const page: string | number = pages[currPos];\n        const targetPageIdx: number = typeof page === 'number' ?\n            page - 1 :\n            this.getPageIdxForSpread(curr, maxSpread, currPos < activePos);\n        return targetPageIdx;\n    }\n}"],"names":["PgnHandle","modOption","existingOption","baseOption","getDefOption","page","increment","incrementIdx","maxSpread","list","pgnOption","defOption","defIncrmVal","Object","assign","perPage","getNoPerPage","totalRecord","length","defState","getDefState","totalPage","getTotalPage","getCurrPage","curr","pageNo","currSlice","getPageSliceIdx","startIdx","endIdx","recordCtx","getRecordCtx","spreadCtx","getSpreadCtx","relPage","getRelPage","relPageCtx","getRelPageCtx","last","parseRelPage","hsRecord","startRecord","Number","isInteger","endRecord","incrms","incrmIdx","fallbackVal","hsIncrms","incrm","isValidIncrm","filter","lsLen","noOfPage","Math","ceil","lastPage","currPage","first","prev","next","pageRange","relPageKeys","getOwnPropertyNames","reduce","type","pageQuery","target","canNavToPage","forEach","pageType","isDefined","undefined","currPageNo","spreadRange","Array","firstPage","DOTS","rtTotalRemain","ltTotalRemain","hsRtSpread","hsLtSpread","rtSpread","container","item","idx","isInRange","hsGtOnePageTilLastPage","push","ltSpread","hsGtOnePageTilFirstPage","unshift","currPageIdx","isLtSpread","isGteZero","val","vals","isArray","every","data","option","state","callback","onEvt","getGenericCmpEvtHandler","firstBtnAttr","getTextBtnAttr","prevBtnAttr","nextBtnAttr","lastBtnAttr","ltSpreadBtnsAttr","map","getSpreadBtnAttr","rtSpreadBtnsAttr","perPageSelectAttr","getPerPageSelectAttr","pageSelectAttr","getPageSelectAttr","title","pageIdx","disabled","onClick","isNum","targetPageIdx","getPageIdxForSpread","isSpread","isLteOnePage","leftOptions","rightOptions","options","selectedOptionIdx","selectedOptionValue","onSelect","getTargetPageIdxByPos","parseInt","value","getOption","pgnState","getState","pages","currPos","activePos"],"mappings":"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"}